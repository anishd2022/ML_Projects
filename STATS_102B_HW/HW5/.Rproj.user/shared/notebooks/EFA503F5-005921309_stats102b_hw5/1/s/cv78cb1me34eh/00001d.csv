"0","# set seed for reproducibility:"
"0","set.seed(1313)"
"0",""
"0","# use 6 fold cross validation:"
"0","k_values <- c(3, 7, 11, 21, 51)"
"0",""
"0","# creating a k fold cross validation function"
"0","k_fold_cv <- function(data, k, K = 6) {"
"0","  # find number of observations:"
"0","  n <- nrow(data)"
"0","  # randomly shuffle the indices:"
"0","  indices <- sample(1:n)"
"0","  # set each testing set to have n/K data points:"
"0","  fold_size <- ceiling(n / K)"
"0","  # set an empty vector of length K to be filled with misclassification values for later:"
"0","  misclassification_values <- numeric(K)"
"0","  "
"0","  # for each fold..."
"0","  for (i in 1:K) {"
"0","    start_index <- (i - 1) * fold_size + 1"
"0","    end_index <- min(i * fold_size, n)"
"0","    test_indices <- indices[start_index:end_index]"
"0","    # set train indices to be everything except what you are testing on"
"0","    train_indices <- indices[-(start_index:end_index)]"
"0","    "
"0","    # train the model on the training set:"
"0","    trainx <- data[train_indices, c(""total_points"", ""hp"")]"
"0","    trainy <- data[train_indices, ]$is_legendary"
"0","    testx <- data[test_indices, c(""total_points"", ""hp"")]"
"0","    "
"0","    pred_labels <- knn(trainx, trainy, testx, k)"
"0","    true_labels <- data[test_indices, ]$is_legendary"
"0",""
"0","    # calculate misclassification rate"
"0","    rate <- GetMisclassificationRate(pred_labels, true_labels)"
"0","    # append rate to result vector"
"0","    misclassification_values <- append(misclassification_values, rate)"
"0","  }"
"0","  "
"0","  # return the result"
"0","  mean(misclassification_values)"
"0","}"
"0",""
"0",""
"0","# run k-fold cross validation for all k values:"
"0","cv_results <- sapply(k_values, function(k) k_fold_cv(gen1, k, K = 6))"
"0","results_df <- data.frame(k = k_values, misclassification_rate = cv_results)"
"0","results_df"
